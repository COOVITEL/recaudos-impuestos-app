import{j as e,c as B,g as H}from"./registersRecaudos.MibmRSbY.js";import{r as n}from"./index.NEDEFKed.js";function g(){const t=new Date,o=t.getFullYear(),s=(t.getMonth()+1).toString().padStart(2,"0"),a=t.getDate().toString().padStart(2,"0");return`${o}${s}${a}`}function M(){const t=new Date,o=t.getFullYear(),s=(t.getMonth()+1).toString().padStart(2,"0"),a=(t.getDate()+1).toString().padStart(2,"0");return`${o}${s}${a}`}function z(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",id:"_x32_",width:350,viewBox:"10 10 512 512",children:e.jsxs("g",{children:[e.jsx("rect",{y:"94.103",className:"st0",width:"48.569",height:"323.795"}),e.jsx("rect",{x:"72.854",y:"94.103",className:"st0",width:"24.284",height:"323.795"}),e.jsx("polygon",{className:"st0",points:"121.423,94.103 121.423,417.897 145.708,417.897 169.992,417.897 169.992,94.103 145.708,94.103  "}),e.jsx("polygon",{className:"st0",points:"194.277,94.103 194.277,417.897 218.561,417.897 242.846,417.897 242.846,94.103 218.561,94.103  "}),e.jsx("rect",{x:"267.13",y:"94.103",className:"st0",width:"24.285",height:"323.795"}),e.jsx("polygon",{className:"st0",points:"339.984,94.103 315.7,94.103 315.7,417.897 339.984,417.897 364.269,417.897 388.554,417.897    388.554,94.103 364.269,94.103  "}),e.jsx("polygon",{className:"st0",points:"412.838,94.103 412.838,417.897 437.122,417.897 462.083,417.897 462.083,94.103 437.122,94.103  "}),e.jsx("rect",{x:"487.044",y:"94.103",className:"st0",width:"24.956",height:"323.795"})]})})}function I(){return`018918008461${g()}06600000037000003823${M()}0600A01`}function V(t){return`05${t}0001`}function Y(t,o){const s=t.padStart(48,"0"),a=o.padStart(10,"0"),i=`06${s}${a}00020100000000000000000370000002`;return console.log(i),i}function _(){let t=g();return`${t.substring(0,4)}-${t.substring(4,6)}-${t.substring(6,8)}`}async function K({convenio:t,valuePay:o,factura:s}){const a={encabezadoArchivo:I(),encabezadoLote:V(t),registroDetalle:Y(s,o),fecha:_()};try{return await B(a),{success:!0,data:(await H()).data.reverse()[0].id}}catch(i){return console.log(i),{success:!1,data:"No se creo el registro"}}}function J(){const[t,o]=n.useState(""),[s,a]=n.useState(0),[i,d]=n.useState(""),[h,m]=n.useState(""),[p,b]=n.useState(""),[j,y]=n.useState(""),[u,w]=n.useState(!1),[k,S]=n.useState(!1),[D,x]=n.useState(!1),[R,N]=n.useState(!1),[C,v]=n.useState(!1),[E,f]=n.useState(!1),[F,L]=n.useState(""),l=n.useCallback(r=>{if(r.key==="Enter"){if(window.removeEventListener("keydown",l),w(!1),f(!1),t!==""){d(t.substring(52,60));const c=g();parseInt(t.substring(52,60))<parseInt(c)?S(!0):(m(t.substring(38,50)),b(t.substring(20,32)),y(t.substring(3,16)),x(!0))}return}if(r.key!=="Alt"&&r.key!=="("&&r.key!==")"){if((s===32||s===53)&&r.key==="0"){a(c=>c+1);return}if((s===33||s===54)&&r.key==="2"){a(c=>c+1);return}if((s===34||s===55)&&r.key==="9"){a(c=>c+1);return}else o(c=>c+r.key),a(c=>c+1)}},[t,s]);n.useEffect(()=>(u?window.addEventListener("keydown",l):(f(!1),window.removeEventListener("keydown",l)),()=>{window.removeEventListener("keydown",l)}),[u,s,l]);function $(){o(""),y(""),a(0),m(""),d(""),b(""),S(!1),x(!1)}function A(){f(!0),N(!1),v(!1),$(),w(r=>!r)}async function P(){$(),x(!1);const r=await K({convenio:j,valuePay:h,factura:p});r.success?(L(r.data),N(!0)):v(!0)}return e.jsxs("div",{className:"flex flex-col justify-center items-center bg-white py-5 px-10 rounded-2xl",children:[e.jsxs("div",{onClick:A,className:`flex flex-col h-[250px] cursor-pointer justify-center mb-5 items-center border-2 rounded-lg border-gray-500 border-solid hover:scale-105 transition-all duration-300 ${u?"bg-blue-400/50":""}`,children:[e.jsx(z,{}),e.jsx("h1",{className:"text-center pb-5",children:"Escanear codigo"})]}),k&&e.jsx("h4",{className:"text-5xl text-red-600",children:"La fecha de pago expiro"}),R&&e.jsxs("span",{className:"text-2xl border-b-2 border-[#007eb8] text-[#007eb8] font-semibold",children:["Registro de Recaudo Exitoso - # ",F.toString().padStart(5,"0")]}),C&&e.jsx("span",{className:"text-2xl border-b-2 border-red-600 text-red-600 font-semibold",children:"Registro de Recaudo Fallido"}),E&&e.jsx("span",{className:"text-2xl font-mono font-semibold",children:"Por favor escanee el codigo"}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("h3",{children:[e.jsx("strong",{children:"Codigo:"})," ",t]}),e.jsxs("h3",{children:[e.jsx("strong",{children:"Fecha:"})," ",i]}),e.jsxs("h3",{children:[e.jsx("strong",{children:"Monto:"})," ",h]}),e.jsxs("h3",{children:[e.jsx("strong",{children:"N. Factura:"})," ",p]}),e.jsxs("h3",{children:[e.jsx("strong",{children:"Convenio:"})," ",j]})]}),e.jsx("button",{className:`cursor-pointer text-2xl mt-4 px-4 py-2 rounded-md bg-[#007eb8] text-white border-2 hover:bg-[#2d2e83] transition duration-300 hover:scale-105 ${D?"":"hidden"}`,onClick:()=>P(),children:"Enviar"})]})}export{J as default};
